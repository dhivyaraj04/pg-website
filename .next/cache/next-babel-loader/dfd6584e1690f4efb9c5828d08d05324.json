{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { ChatButton } from \"../../components/button/button\";\nimport { Subtext, CardBlock, SpaceTag, FlexTag, ImageTag, OrderTag, ListTag, LoadMorebutton, ChatContainer, ChatBot, ChatContent, ChatHeader, InputTag, HorizontalLine } from \"../../components/small-component\";\nimport { Icon } from \"../../components/icon/icon\";\nimport { Icons } from \"../../components/icon/icons-props\";\nimport * as Logo from \"../../img/logo.png\";\nimport { BaseUrl } from \"../../url\";\nexport function Chat() {\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      open = _React$useState2[0],\n      setOpen = _React$useState2[1];\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      buttonName = _React$useState4[0],\n      setButtonName = _React$useState4[1];\n\n  var bottomRef = useRef(null);\n\n  var _useState = useState(\"\"),\n      values = _useState[0],\n      setValue = _useState[1];\n\n  var _useState2 = useState(false),\n      typeBox = _useState2[0],\n      setTypeBox = _useState2[1];\n\n  var _useState3 = useState([]),\n      messages = _useState3[0],\n      setMessages = _useState3[1];\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      expertise = _React$useState6[0],\n      setExpertise = _React$useState6[1];\n\n  var _React$useState7 = React.useState([]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      subExpertise = _React$useState8[0],\n      setSubExpertise = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      expertiseId = _React$useState10[0],\n      setExpertiseId = _React$useState10[1];\n\n  var _React$useState11 = React.useState(\"\"),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      subExpertiseId = _React$useState12[0],\n      setSubExpertiseId = _React$useState12[1];\n\n  var _React$useState13 = React.useState(\"\"),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      queryContent = _React$useState14[0],\n      setQueryContent = _React$useState14[1];\n\n  var _React$useState15 = React.useState(\"\"),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      phone = _React$useState16[0],\n      setPhone = _React$useState16[1];\n\n  var _React$useState17 = React.useState(\"\"),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      queryTitle = _React$useState18[0],\n      setQueryTitle = _React$useState18[1];\n\n  function onClickEvent() {\n    setOpen(!open);\n  }\n\n  var scrollToBottom = function scrollToBottom() {\n    bottomRef.current.scrollIntoView({\n      behavior: \"smooth\",\n      block: \"start\"\n    });\n  };\n\n  function nextQuestion(name, id, e) {\n    setExpertiseId(id);\n    setButtonName(_objectSpread(_objectSpread({}, buttonName), {}, _defineProperty({}, name, e.target.name)));\n    getSubExpertItem(id);\n    scrollToBottom();\n    var dev = subExpertise.filter(function (eve) {\n      return onSelectDevice(eve, name);\n    });\n    dev.length === 0 ? \"\" : getQuery(id);\n  }\n\n  useEffect(function () {\n    getExpertis();\n  }, []);\n\n  function getExpertis() {\n    return _getExpertis.apply(this, arguments);\n  }\n\n  function _getExpertis() {\n    _getExpertis = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res, data, content;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(BaseUrl, \"/apiV2/expertises\"), {\n                method: \"GET\"\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              data = _context.sent;\n              content = {\n                text: \"Select your area of expertise\",\n                button: data.expertises\n              };\n              setExpertise([content]);\n              setMessages(messages.concat(content));\n              scrollToBottom();\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _getExpertis.apply(this, arguments);\n  }\n\n  function getSubExpertItem(_x) {\n    return _getSubExpertItem.apply(this, arguments);\n  }\n\n  function _getSubExpertItem() {\n    _getSubExpertItem = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(expertiseId) {\n      var res, data, content;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"\".concat(BaseUrl, \"/apiV2/expertise_subexpertise/\").concat(expertiseId), {\n                method: \"GET\"\n              });\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return res.json();\n\n            case 5:\n              data = _context2.sent;\n              content = [{\n                text: \"Select your area of Sub expertise\",\n                button: data.subExpertise\n              }];\n              setSubExpertise(data.subExpertise);\n              setMessages(messages.concat(content));\n\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _getSubExpertItem.apply(this, arguments);\n  }\n\n  function getQuery(_x2) {\n    return _getQuery.apply(this, arguments);\n  }\n\n  function _getQuery() {\n    _getQuery = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n      var content;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setSubExpertiseId(id);\n              setTypeBox(true);\n              content = [{\n                text: \"Please provide your Query Title ?\"\n              }];\n              setMessages(messages.concat(content));\n              scrollToBottom();\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n    return _getQuery.apply(this, arguments);\n  }\n\n  var onSelectDevice = function onSelectDevice(deviceObj, sDevice) {\n    return deviceObj.name === sDevice;\n  };\n\n  function onChangeEvent(e) {\n    var _ref = e.target,\n        value = _ref.value;\n    setValue(value);\n  }\n\n  function onSubmitEvent(event) {\n    event.preventDefault();\n    setValue(\"\");\n  }\n\n  function handleKeyDown(e) {\n    var _ref2 = e.target,\n        value = _ref2.value;\n\n    if (e.key === \"Enter\") {\n      var green = messages[messages.length - 1];\n      green.text === \"Please provide your Query Title ?\" ? getNextQuery(value) : \"\";\n      green.text === \"Please can you elaborate your Query ?\" ? getNextElaborateQuery(value) : \"\";\n      green.text === \"Please provide your Mobile Number, so that we can forward you playstore link\" ? getPhone(value) : \"\";\n    }\n  }\n\n  function getNextQuery(value) {\n    setQueryTitle(value);\n    var content = [{\n      text1: value\n    }, {\n      text: \"Please can you elaborate your Query ?\"\n    }];\n    setMessages(messages.concat(content));\n  }\n\n  function getNextElaborateQuery(value) {\n    setQueryContent(value);\n    var content = [{\n      text1: value\n    }, {\n      text: \"Your query has been posted to our experts, you can find your query answer in your Protalk app\"\n    }, {\n      text: \"Please provide your Mobile Number, so that we can forward you playstore link\"\n    }];\n    setMessages(messages.concat(content));\n  }\n\n  function getPhone(value) {\n    setPhone(value);\n    var content = [{\n      text1: value\n    }, {\n      text: \"Thank you for you interest, We provide you 10% Discount coupon (“FIRSTPRO” Code) for your first service in protalk app\"\n    }];\n    setMessages(messages.concat(content));\n    postApi(value);\n  }\n\n  function postApi(value) {\n    console.log(expertiseId, subExpertiseId, queryTitle, queryContent, phone, \"body\");\n    fetch(\"\".concat(BaseUrl, \"/apiV2/website_bot/create_request\"), {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        expertiseId: expertiseId,\n        subExpertiseId: subExpertiseId,\n        queryTitle: queryTitle,\n        queryContent: queryContent,\n        phoneNumber: value\n      })\n    }).then(function (response) {\n      return response.json();\n    }).then(function (res) {\n      console.log(res); // setCount(count + 1);\n    });\n  }\n\n  return __jsx(React.Fragment, null, __jsx(ChatContainer, null, __jsx(ChatButton, {\n    onClickEvent: onClickEvent\n  }, __jsx(Icon, {\n    name: Icons.chat\n  }))), open === true ? __jsx(ChatBot, null, __jsx(ChatHeader, null, __jsx(SpaceTag, {\n    marginTop: \"10\",\n    marginBottom: \"10\"\n  }, __jsx(Subtext, {\n    color: \"#fff\",\n    fontSize: \"20px\",\n    letterSpacing: \"0.56px\",\n    fontWeight: \"600\"\n  }, \"Welcome to Protalk\")), __jsx(SpaceTag, {\n    marginTop: \"10\",\n    marginBottom: \"10\"\n  }, __jsx(Subtext, {\n    color: \"#fff\",\n    fontSize: \"14px\",\n    letterSpacing: \"0.56px\",\n    fontWeight: \"400\"\n  }, \"Budget Friendly Multi consultant application\"))), __jsx(ChatContent, null, __jsx(OrderTag, null, messages.map(function (item, i) {\n    return __jsx(React.Fragment, null, item.text ? __jsx(ListTag, null, __jsx(FlexTag, null, __jsx(SpaceTag, {\n      marginTop: \"10\",\n      marginBottom: \"10\"\n    }, __jsx(ImageTag, {\n      src: Logo,\n      height: \"25\",\n      width: \"25\",\n      borderRadius: \"50%\"\n    })), __jsx(\"div\", null, __jsx(CardBlock, {\n      border: \"0.8px solid rgba(204, 206, 210, 0.5)\",\n      borderRadius: \" 6px\",\n      padding: \"10px\"\n    }, __jsx(Subtext, {\n      color: \"#000\",\n      fontSize: \"12px\",\n      fontWeight: \"400\",\n      lineHeight: \"15px\"\n    }, item.text)), item.button ? __jsx(\"div\", null, item.button.map(function (item, i) {\n      return __jsx(LoadMorebutton, {\n        fontSize: \"12px\",\n        padding: \"10px\",\n        border: \"0.4px solid #029532\",\n        background: \"\".concat(buttonName[item.name] === item.name ? \"#029532\" : \"none\"),\n        color: \"\".concat(buttonName[item.name] === item.name ? \"#fff\" : \"#029532\"),\n        onClick: function onClick(e) {\n          return nextQuestion(item.name, item._id, e);\n        },\n        style: {\n          margin: \"10px\"\n        },\n        name: item.name\n      }, item.name);\n    })) : __jsx(React.Fragment, null)))) : \"\", item.text1 ? __jsx(ListTag, null, __jsx(FlexTag, {\n      justifyContent: \"flex-end\"\n    }, __jsx(CardBlock, {\n      border: \"0.8px solid rgba(204, 206, 210, 0.5)\",\n      borderRadius: \" 6px\",\n      padding: \"10px\"\n    }, __jsx(Subtext, {\n      color: \"#000\",\n      fontSize: \"12px\",\n      fontWeight: \"400\",\n      lineHeight: \"15px\"\n    }, item.text1)))) : __jsx(React.Fragment, null), __jsx(\"div\", {\n      ref: bottomRef\n    }));\n  })), typeBox === false ? __jsx(React.Fragment, null) : __jsx(\"div\", null, __jsx(HorizontalLine, {\n    borderTop: \"1px solid #E3E3E3\"\n  }), __jsx(\"form\", {\n    onSubmit: onSubmitEvent\n  }, __jsx(FlexTag, null, __jsx(InputTag, {\n    value: values,\n    placeholder: \"Type your reply here\",\n    onChange: onChangeEvent,\n    onKeyDown: handleKeyDown\n  })))))) : __jsx(React.Fragment, null));\n}","map":null,"metadata":{},"sourceType":"module"}